<%= form_with model: event, class: "space-y-4", data: { controller: "event-form" } do |form| %>
  <div>
    <%= form.label :title, class: "block text-sm font-medium text-slate-700 mb-1" %>
    <%= form.text_field :title,
          required: true,
          placeholder: "Event title",
          autofocus: true,
          class: "w-full rounded-2xl border border-slate-300/80 bg-white px-4 py-3 text-base text-slate-900 placeholder:text-slate-400 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30" %>
  </div>

  <div class="flex items-center gap-4 mb-4">
    <label class="flex items-center gap-2 cursor-pointer">
      <%= form.check_box :all_day,
            data: { event_form_target: "allDay", action: "change->event-form#toggleTimeFields" },
            class: "rounded border-slate-300 text-blue-600 focus:ring-blue-500" %>
      <span class="text-sm text-slate-700">All day</span>
    </label>

    <div class="flex-1">
      <%= form.label :event_type, "Type", class: "sr-only" %>
      <%= form.select :event_type,
            Event.event_types.keys.map { |t| [t.titleize, t] },
            {},
            class: "appearance-none rounded-2xl border border-slate-300/80 bg-white pl-4 pr-10 py-2 text-sm text-slate-900 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30 bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22m6%208%204%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.25rem_1.25rem] bg-[right_0.75rem_center] bg-no-repeat" %>
    </div>
  </div>

  <div class="grid grid-cols-2 gap-4 transition-opacity" data-event-form-target="timeFields">
    <div>
      <%= form.label :starts_at, "Start", class: "block text-sm font-medium text-slate-700 mb-1" %>
      <%= form.datetime_local_field :starts_at,
            required: true,
            data: { event_form_target: "startsAt", action: "change->event-form#updateEndTime" },
            class: "w-full rounded-2xl border border-slate-300/80 bg-white px-4 py-3 text-base text-slate-900 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30" %>
    </div>
    <div>
      <%= form.label :ends_at, "End", class: "block text-sm font-medium text-slate-700 mb-1" %>
      <%= form.datetime_local_field :ends_at,
            required: true,
            data: { event_form_target: "endsAt" },
            class: "w-full rounded-2xl border border-slate-300/80 bg-white px-4 py-3 text-base text-slate-900 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30" %>
    </div>
  </div>

  <div>
    <%= form.label :location, class: "block text-sm font-medium text-slate-700 mb-1" %>
    <%= form.text_field :location,
          placeholder: "Location (optional)",
          class: "w-full rounded-2xl border border-slate-300/80 bg-white px-4 py-3 text-base text-slate-900 placeholder:text-slate-400 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30" %>
  </div>

  <div>
    <%= form.label :description, class: "block text-sm font-medium text-slate-700 mb-1" %>
    <%= form.text_area :description,
          rows: 3,
          placeholder: "Description (optional)",
          class: "w-full rounded-2xl border border-slate-300/80 bg-white px-4 py-3 text-base text-slate-900 placeholder:text-slate-400 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30 resize-none" %>
  </div>

  <div>
    <%= form.label :project_id, "Link to Project", class: "block text-sm font-medium text-slate-700 mb-1" %>
    <%= form.collection_select :project_id,
          current_user.projects.active.ordered,
          :id, :name,
          { include_blank: "None" },
          class: "w-full rounded-2xl border border-slate-300/80 bg-white px-4 py-3 text-base text-slate-900 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/30" %>
  </div>

  <% if event.errors.any? %>
    <ul class="space-y-1 text-sm text-red-600">
      <% event.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  <% end %>

  <div class="flex items-center gap-3">
    <%= form.submit event.persisted? ? "Update" : "Create",
          class: "rounded-2xl bg-blue-600 px-5 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow-md transition hover:-translate-y-0.5 hover:bg-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-400/40" %>
    <%= link_to "Cancel", events_path,
          class: "text-sm text-slate-500 hover:text-slate-700 transition" %>
  </div>
<% end %>

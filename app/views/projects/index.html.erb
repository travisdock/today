<% content_for :main_class, "flex flex-1 justify-center px-4 py-5 sm:px-6 lg:px-8" %>

<div class="w-full max-w-4xl space-y-6 pb-32">
  <%= render "shared/flash" %>

  <section class="rounded-3xl border border-white/40 bg-white/80 p-6 shadow-xl backdrop-blur">
    <%= link_to new_project_path,
          class: "flex w-full items-center justify-center gap-2 rounded-2xl bg-slate-100 px-4 py-2 text-sm font-semibold uppercase tracking-wide text-slate-600 transition-all duration-200 hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-400" do %>
      <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
        <path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" />
      </svg>
      <span>New project</span>
    <% end %>
  </section>

  <% Project::SECTIONS.each do |section| %>
    <% projects = @projects_grouped[section.to_s] || [] %>

    <section class="rounded-3xl border border-white/30 bg-white/70 p-6 shadow-lg backdrop-blur">
      <div class="flex items-center gap-3 mb-4">
        <h2 class="text-xl font-semibold text-slate-900"><%= section.to_s.titleize %></h2>
        <span class="rounded-full bg-slate-100 px-3 py-1 text-sm font-medium text-slate-600">
          <%= projects.count %>
        </span>
      </div>

      <% if projects.any? %>
        <table class="w-full">
          <thead>
            <tr class="border-b border-slate-200 text-left text-sm font-medium text-slate-500">
              <th class="pb-2 pr-4">Name</th>
              <th class="pb-2 pr-4">Description</th>
              <th class="pb-2 text-right">Overview</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-100">
            <% projects.each do |project| %>
              <tr class="group">
                <td class="py-3 pr-4">
                  <%= link_to project.name, project_path(project),
                        class: "font-medium text-slate-900 hover:text-blue-600 transition" %>
                </td>
                <td class="py-3 pr-4 text-slate-600 max-w-xs truncate">
                  <%= project.description.presence || "—" %>
                </td>
                <td class="py-3 text-right text-sm text-slate-500 whitespace-nowrap">
                  <%= project.thoughts_count %> <%= "thought".pluralize(project.thoughts_count) %>
                  <span class="text-slate-300 mx-1">·</span>
                  <%= time_ago_in_words(project.updated_at) %> ago
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-slate-400 text-sm">No projects in this section.</p>
      <% end %>
    </section>
  <% end %>
</div>
